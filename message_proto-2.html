<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Standardbesked</title>

    <!-- Sets initial viewport load and disables zooming  -->
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">

    <!-- Makes your prototype chrome-less once bookmarked to your phone's home screen -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <!-- Include the compiled Ratchet CSS -->
    <link href="ratchet/css/ratchet.min.css" rel="stylesheet">
    <link href="ratchet/css/ratchet-theme-ios.min.css" rel="stylesheet">
    
    <!-- Include custom styles -->
    <link href="css/main.css" rel="stylesheet">

    <!-- Include the compiled Ratchet JS -->
    <!-- 
    <script src="ratchet/js/ratchet.min.js"></script>
     -->
  </head>
  <body>

    <header class="bar bar-nav">
      <!-- <a class="icon icon-left-nav pull-left" href="index.html">Beskeder</a> -->
      <a href="index.html" data-transition="slide">
        <button class="btn btn-link btn-nav pull-left">
          <span class="icon icon-left-nav"></span>
          Beskeder
        </button>
      </a>
      <div class="context-menu">
        <div class="wheel">
        </div>
        <p>Cykler</p>
      </div>
      <h1 class="title">Mor</h1>
    </header>

    <div class="bar bar-footer bar-footer-proto-2 bar-standard send-messages remove-padding">
        <div class="add-padding">
          <img class="icon-cam" src="img/ios-camera-icon.png" alt="camera" />
          <input class="write-message-input" type="text" placeholder="Tekstbesked">
          <a class="button_send disabled" onclick="sendMessage();">Send</a>
        </div>
        <div class="additional_input">
          <div class="audio-container" onclick="recordMessage();">
            <div class="microphone-input">
            </div>
            <p>Talebesked</p>
          </div>
          <div class="message-container" onclick="sendPrewrittenMessage();">
            <div class="prewritten-message">Cykler lige nu. Jeg skriver tilbage om lidt.</div>
            <div class="record-timer">0:00
            </div>
            <p class="prewritten-description">Standardbesked</p>
          </div>
        </div>
    </div>

    <div class="content proto-2">
      <ul class="messages">
        <li class="time"><strong>i dag</strong> 11.08</li>
        <li class="send-bubble">Hej Mor. Hvad tid kommer du hjem i dag?</li>
        <li class="receive-bubble">Hej Lotte. Jeg t√¶nker det bliver omkring kl. 17.</li>
      </ul>
    </div>    

    <script type="text/javascript">

      var textInput = document.querySelector('.write-message-input');
      var btnSend = document.querySelector('.button_send');

      function checkInputValue() {
        if (textInput.value) {
          btnSend.classList.remove('disabled'); // Remove disabled class if input has value
        } else {
          btnSend.classList.add('disabled'); // Add disabled class if input does not have value
        }
        window.setTimeout("checkInputValue();", 100);
      }

      checkInputValue();

      // Send messages
      var msgContainer = document.querySelector('.messages');

      function sendMessage() {
        var textInputValue = textInput.value; // Get value from input field
        var newMsgLi = document.createElement('li'); // Create new li for new message

        newMsgLi.className = 'send-bubble animate-in'; // Add class name to message li
        newMsgLi.innerHTML = textInputValue; // Input text message to message li
        msgContainer.appendChild(newMsgLi); // Append message li to message container

        textInput.value = ''; // Clear value for input field
        setTimeout(function() { scrollToBottom(); }, 600);
      }

      // Send prewritten message

      var barFooter = document.querySelector('.bar-footer');

      function sendPrewrittenMessage() {
        var newMsgLi = document.createElement('li'); // Create new li for new message
        var cycleIcon = document.createElement('div'); // Create new div for cycle icon
        
        newMsgLi.innerHTML = "Cykler lige nu. Jeg skriver tilbage om lidt."; // Input text message to message li

        newMsgLi.className = 'send-bubble animate-in extra-margin'; // Add class name to message li
        cycleIcon.className = 'cycle-icon'; // Add class name to cycle icon
        newMsgLi.appendChild(cycleIcon);
        msgContainer.appendChild(newMsgLi); // Append message li to message container

        textInput.value = ''; // Clear value for input field
        barFooter.className = 'bar bar-footer bar-footer-proto-2 bar-standard send-messages remove-padding animate-out';
        setTimeout(function() { scrollToBottom(); }, 600);
        //setTimeout(function() { barFooter.className = 'hide' }, 600);
      }

      // Scroll to bottom
      function scrollToBottom() {
        var contentDiv = document.querySelector('.content');
        contentDiv.scrollTop = contentDiv.scrollHeight;
      }

      function recordMessage() {
        var preWrittenMessage = document.querySelector('.prewritten-message');
        var microphoneInput = document.querySelector('.microphone-input');
        var messageContainer = document.querySelector('.message-container');
        var preWrittenDescription = document.querySelector('.prewritten-description');

        preWrittenMessage.className = 'prewritten-message animate-premessage-out'; // Add class to preWrittenMessage
        microphoneInput.className = 'microphone-input animate-pulse' // Add class to microphoneInput
        preWrittenDescription.className ='prewritten-description animate-fadeout' // Add class name to preWrittenDescription

        // var timerDiv = document.createElement('div') // Create timerDiv
        // timerDiv.className = 'record-timer';
        // timerDiv.innerHTML = 'hej';
        // messageContainer.appendChild(timerDiv); // Append timerDiv to messageContainer
      }

      
      // Run functions
      checkInputValue();
      scrollToBottom();

    </script>

  </body>
</html>